#!/bin/bash

set -o errexit
set -o nounset

# Support optional debug mode via CELERY_DEBUG environment variable
if [ "${CELERY_DEBUG:-0}" = "1" ]; then
    exec python -m debugpy --listen 0.0.0.0:5678 -m celery -A config.celery_app worker --queues=antenna -l INFO
else
    exec watchfiles --filter python celery.__main__.main --args '-A config.celery_app worker --queues=antenna -l INFO'
fi
