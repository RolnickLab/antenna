#!/bin/bash

set -o errexit
set -o pipefail
set -o nounset

# Launch VS Code debug server if DEBUGGER environment variable is set to 1
# Note that auto reloading is disabled when debugging, manual restart required for code changes.
if [ "${DEBUGGER:-0}" = "1" ]; then
    exec watchfiles --filter python 'python -m debugpy --listen 0.0.0.0:5679 -m celery -A config.celery_app worker -l INFO'
else
    exec watchfiles --filter python celery.__main__.main --args '-A config.celery_app worker -l INFO'
fi
